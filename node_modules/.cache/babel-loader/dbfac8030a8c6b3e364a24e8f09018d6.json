{"ast":null,"code":"import _regeneratorRuntime from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/regenerator\";import _defineProperty from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _asyncToGenerator from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import{Link}from'react-router-dom';import{Redirect}from'react-router';import{MDBContainer,MDBRow,MDBCard,MDBCardBody,MDBModalFooter}from'mdbreact';import'./connexion.css';import axios from'axios';var Login=/*#__PURE__*/function(_React$Component){_inherits(Login,_React$Component);function Login(props){var _this;_classCallCheck(this,Login);_this=_possibleConstructorReturn(this,_getPrototypeOf(Login).call(this,props));_this.change=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.setState(_defineProperty({},e.target.id,e.target.value));case 2:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.handleSubmitLogIn=function(e){var _this$state=_this.state,email=_this$state.email,password=_this$state.password;//cas ou tous les champs sont remplis\nif(password&&email){console.log(_this.state);var formData=new FormData();formData.append(\"email\",_this.state.email);formData.append(\"password\",_this.state.password);var url=\"http://localhost:8888/API/Connexion/login.php\";axios.post(url,formData,{withCredentials:true})//succès connexion\n.then(function(response){this.setState({loggedIn:true});//si la connexion marche, change le statut de connexion comme vrai, redirection dans le render\nconsole.log(\"connexion réussie - email et mot de passe valides\",response);}.bind(_assertThisInitialized(_this)))//echec connexion\n.catch(function(error){if(error.response&&error.response.status===403){_this.setState({error:error.response.data});}console.log(\"login non réussi\");});}else{//cas ou tous les champs ne sont pas remplis\n_this.setState({error:'Veuillez saisir tous les champs !'});}setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};_this.state={password:null,//va contenir la valeur entrée pour le champs \"mot de passe\" du formulaire\nemail:null,//va contenir la valeur entrée pour le champs \"adresse mail\" du formulaire\nloggedIn:false,//initialise le statut de connexion comme faux\nerror:''//va contenir l'erreur en cas d'erreur\n};return _this;}//methode qui permet d'attribuer à \"email\" et \"password\" les valeurs entrées au clavier par l'utilisateur\n_createClass(Login,[{key:\"render\",value:function render(){var error=this.state.error;var loggedIn=this.state.loggedIn;if(loggedIn){//redirection vers la page d'acceuil si la connexion est réussie\nreturn React.createElement(Redirect,{to:\"/accueil\"});}//affichage du formulaire de connexion a completer par l'utilisateur\nreturn React.createElement(\"div\",null,React.createElement(\"h1\",{className:\"myBibli\"},\"MyBibli\"),React.createElement(MDBContainer,{className:\"containerConnexion\"},React.createElement(MDBRow,null,React.createElement(MDBCard,null,React.createElement(MDBCardBody,{className:\"mx-4\"},React.createElement(\"form\",{onSubmit:this.handleSubmitLogIn},React.createElement(\"div\",{className:\"text-center\"},React.createElement(\"h2\",{className:\"dark-grey-text mb-5\"},\"Connexion\")),React.createElement(\"label\",{htmlFor:\"email\",className:\"grey-text\"},\"Adresse mail\",React.createElement(\"input\",{type:\"email\",id:\"email\",name:\"email\",className:\"form-control\",onChange:this.change})),React.createElement(\"br\",null),React.createElement(\"label\",{htmlFor:\"password\",className:\"grey-text\"},\"Mot de passe\",React.createElement(\"input\",{type:\"password\",id:\"password\",name:\"password\",className:\"form-control\",onChange:this.change})),React.createElement(\"p\",{className:\"font-small blue-text d-flex justify-content-end pb-3\"}),React.createElement(\"div\",{className:\"text-center mb-3\"},React.createElement(\"button\",{type:\"submit\",className:\"btn btn-primary\",onClick:this.handleSubmitLogIn},\"Se connecter\"),error&&React.createElement(\"p\",{className:\"error\"},error)),React.createElement(\"p\",{className:\"font-small dark-grey-text text-right d-flex justify-content-center mb-3 pt-2\"}))),React.createElement(MDBModalFooter,{className:\"mx-5 pt-3 mb-1\"},React.createElement(\"p\",{className:\"font-small grey-text d-flex justify-content-end\"},React.createElement(Link,{to:\"/inscription\",className:\"blue-text ml-1\"},\"S'inscrire\")))))));}}]);return Login;}(React.Component);export default Login;","map":{"version":3,"sources":["/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/src/components/Connexion/connexion.js"],"names":["React","Link","Redirect","MDBContainer","MDBRow","MDBCard","MDBCardBody","MDBModalFooter","axios","Login","props","change","e","setState","target","id","value","handleSubmitLogIn","state","email","password","console","log","formData","FormData","append","url","post","withCredentials","then","response","loggedIn","bind","catch","error","status","data","setTimeout","preventDefault","Component"],"mappings":"2xCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CAEA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,QAAT,KAAwB,cAAxB,CACA,OACEC,YADF,CACgBC,MADhB,CACwBC,OADxB,CACiCC,WADjC,CAC8CC,cAD9C,KAEO,UAFP,CAGA,MAAO,iBAAP,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,C,GAGMC,CAAAA,K,2EACJ,eAAYC,KAAZ,CAAmB,uCACjB,uEAAMA,KAAN,GADiB,MAYnBC,MAZmB,0FAYV,iBAAMC,CAAN,wIACD,OAAKC,QAAL,oBACHD,CAAC,CAACE,MAAF,CAASC,EADN,CACWH,CAAC,CAACE,MAAF,CAASE,KADpB,EADC,uDAZU,qEAmBnBC,iBAnBmB,CAmBC,SAAAL,CAAC,CAAI,iBACK,MAAKM,KADV,CACfC,KADe,aACfA,KADe,CACRC,QADQ,aACRA,QADQ,CAGvB;AACA,GAAIA,QAAQ,EAAID,KAAhB,CAAuB,CAErBE,OAAO,CAACC,GAAR,CAAY,MAAKJ,KAAjB,EACA,GAAIK,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAf,CACAD,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAwB,MAAKP,KAAL,CAAWC,KAAnC,EACAI,QAAQ,CAACE,MAAT,CAAgB,UAAhB,CAA2B,MAAKP,KAAL,CAAWE,QAAtC,EACA,GAAMM,CAAAA,GAAG,CAAG,+CAAZ,CACAlB,KAAK,CAACmB,IAAN,CAAWD,GAAX,CAAgBH,QAAhB,CAA0B,CAACK,eAAe,CAAE,IAAlB,CAA1B,CAEA;AAFA,CAGCC,IAHD,CAGM,SAASC,QAAT,CAAmB,CACvB,KAAKjB,QAAL,CAAc,CAACkB,QAAQ,CAAE,IAAX,CAAd,EAAgC;AAChCV,OAAO,CAACC,GAAR,CAAY,mDAAZ,CAAiEQ,QAAjE,EACD,CAHK,CAGJE,IAHI,+BAHN,CAQA;AARA,CASCC,KATD,CASO,SAACC,KAAD,CAAW,CAChB,GAAGA,KAAK,CAACJ,QAAN,EAAkBI,KAAK,CAACJ,QAAN,CAAeK,MAAf,GAA0B,GAA/C,CAAmD,CACjD,MAAKtB,QAAL,CAAc,CACZqB,KAAK,CAAEA,KAAK,CAACJ,QAAN,CAAeM,IADV,CAAd,EAGD,CACDf,OAAO,CAACC,GAAR,CAAY,kBAAZ,EAED,CAjBD,EAoBD,CA3BD,IA2BO,CACL;AACA,MAAKT,QAAL,CAAc,CACZqB,KAAK,CAAE,mCADK,CAAd,EAGD,CAEDG,UAAU,CAAC,UAAM,CACf,MAAKxB,QAAL,CAAc,CACZqB,KAAK,CAAE,EADK,CAAd,EAGD,CAJS,CAIP,IAJO,CAAV,CAMAtB,CAAC,CAAC0B,cAAF,GAID,CAnEkB,CAEjB,MAAKpB,KAAL,CAAa,CACXE,QAAQ,CAAE,IADC,CACI;AACfD,KAAK,CAAE,IAFI,CAEC;AACZY,QAAQ,CAAE,KAHC,CAGM;AACjBG,KAAK,CAAE,EAAG;AAJC,CAAb,CAFiB,aASlB,CAED;yDA0DS,IACCA,CAAAA,KADD,CACW,KAAKhB,KADhB,CACCgB,KADD,IAEAH,CAAAA,QAFA,CAEa,KAAKb,KAFlB,CAEAa,QAFA,CAIP,GAAGA,QAAH,CAAY,CACV;AACA,MAAO,qBAAC,QAAD,EAAU,EAAE,CAAC,UAAb,EAAP,CACD,CAED;AACA,MACE,gCACE,0BAAI,SAAS,CAAC,SAAd,YADF,CAEE,oBAAC,YAAD,EAAc,SAAS,CAAC,oBAAxB,EACE,oBAAC,MAAD,MACE,oBAAC,OAAD,MACE,oBAAC,WAAD,EAAa,SAAS,CAAC,MAAvB,EACE,4BAAM,QAAQ,CAAE,KAAKd,iBAArB,EACE,2BAAK,SAAS,CAAC,aAAf,EACE,0BAAI,SAAS,CAAC,qBAAd,cADF,CADF,CAME,6BAAO,OAAO,CAAC,OAAf,CAAuB,SAAS,CAAC,WAAjC,iBAEE,6BACE,IAAI,CAAC,OADP,CAEE,EAAE,CAAC,OAFL,CAGE,IAAI,CAAC,OAHP,CAIE,SAAS,CAAC,cAJZ,CAKE,QAAQ,CAAE,KAAKN,MALjB,EAFF,CANF,CAiBE,8BAjBF,CAkBE,6BAAO,OAAO,CAAC,UAAf,CAA0B,SAAS,CAAC,WAApC,iBAEE,6BACE,IAAI,CAAC,UADP,CAEE,EAAE,CAAC,UAFL,CAGE,IAAI,CAAC,UAHP,CAIE,SAAS,CAAC,cAJZ,CAKE,QAAQ,CAAE,KAAKA,MALjB,EAFF,CAlBF,CA6BE,yBAAG,SAAS,CAAC,sDAAb,EA7BF,CAgCE,2BAAK,SAAS,CAAC,kBAAf,EACE,8BAAQ,IAAI,CAAC,QAAb,CAAsB,SAAS,CAAC,iBAAhC,CAAkD,OAAO,CAAE,KAAKM,iBAAhE,iBADF,CAGGiB,KAAK,EACL,yBAAG,SAAS,CAAC,OAAb,EAAsBA,KAAtB,CAJH,CAhCF,CAwCE,yBAAG,SAAS,CAAC,8EAAb,EAxCF,CADF,CADF,CA6CE,oBAAC,cAAD,EAAgB,SAAS,CAAC,gBAA1B,EACE,yBAAG,SAAS,CAAC,iDAAb,EAEE,oBAAC,IAAD,EAAM,EAAE,CAAC,cAAT,CAAwB,SAAS,CAAC,gBAAlC,eAFF,CADF,CA7CF,CADF,CADF,CAFF,CADF,CAiED,C,mBAjJiBlC,KAAK,CAACuC,S,EAoJ1B,cAAe9B,CAAAA,KAAf","sourcesContent":["import React from 'react';\n\nimport { Link } from 'react-router-dom';\nimport { Redirect} from 'react-router';\nimport {\n  MDBContainer, MDBRow, MDBCard, MDBCardBody, MDBModalFooter,\n} from 'mdbreact';\nimport './connexion.css';\nimport axios from 'axios';\n\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: null,//va contenir la valeur entrée pour le champs \"mot de passe\" du formulaire\n      email: null,//va contenir la valeur entrée pour le champs \"adresse mail\" du formulaire\n      loggedIn: false, //initialise le statut de connexion comme faux\n      error: '',//va contenir l'erreur en cas d'erreur\n\n    };\n  }\n\n  //methode qui permet d'attribuer à \"email\" et \"password\" les valeurs entrées au clavier par l'utilisateur\n  change = async e => {\n    await this.setState({\n      [e.target.id]: e.target.value,\n    });\n  }\n\n  //methode qui permet d'envoyer les données au fichier PHP \"login.php\" afin de verifier l'identification de l'utilisateur, lorque celui-ci appuie sur le bouton \"valider\"\n  handleSubmitLogIn = e => {\n    const { email, password } = this.state;\n\n    //cas ou tous les champs sont remplis\n    if (password && email) {\n      \n      console.log(this.state);\n      let formData = new FormData();\n      formData.append(\"email\",this.state.email);\n      formData.append(\"password\",this.state.password);\n      const url = \"http://localhost:8888/API/Connexion/login.php\";\n      axios.post(url, formData, {withCredentials: true})\n\n      //succès connexion\n      .then(function(response) {  \n        this.setState({loggedIn: true});//si la connexion marche, change le statut de connexion comme vrai, redirection dans le render\n        console.log(\"connexion réussie - email et mot de passe valides\", response);\n      }.bind(this))\n\n      //echec connexion\n      .catch((error) => {\n        if(error.response && error.response.status === 403){\n          this.setState({\n            error: error.response.data,\n            });\n        }\n        console.log(\"login non réussi\");\n\n      });\n\n\n    } else {\n      //cas ou tous les champs ne sont pas remplis\n      this.setState({\n        error: 'Veuillez saisir tous les champs !',\n      });\n    }\n\n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n        \n    e.preventDefault();\n\n   \n    \n  }\n\n  render() {\n    const { error } = this.state;\n    const {loggedIn } = this.state;\n\n    if(loggedIn){\n      //redirection vers la page d'acceuil si la connexion est réussie\n      return <Redirect to=\"/accueil\"/>;\n    }\n  \n    //affichage du formulaire de connexion a completer par l'utilisateur\n    return (\n      <div>\n        <h1 className=\"myBibli\">MyBibli</h1>\n        <MDBContainer className=\"containerConnexion\">\n          <MDBRow>\n            <MDBCard>\n              <MDBCardBody className=\"mx-4\">\n                <form onSubmit={this.handleSubmitLogIn}>\n                  <div className=\"text-center\">\n                    <h2 className=\"dark-grey-text mb-5\">\n                      Connexion\n                    </h2>\n                  </div>\n                  <label htmlFor=\"email\" className=\"grey-text\">\n                    Adresse mail\n                    <input\n                      type=\"email\"\n                      id=\"email\"\n                      name=\"email\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                    />\n                  </label>\n\n                  <br />\n                  <label htmlFor=\"password\" className=\"grey-text\">\n                    Mot de passe\n                    <input\n                      type=\"password\"\n                      id=\"password\"\n                      name=\"password\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                    />\n                  </label>\n\n                  <p className=\"font-small blue-text d-flex justify-content-end pb-3\">\n\n                  </p>\n                  <div className=\"text-center mb-3\">\n                    <button type=\"submit\" className=\"btn btn-primary\" onClick={this.handleSubmitLogIn}>Se connecter</button>\n                    {\n                     error && (\n                     <p className=\"error\">{error}</p>\n                     )\n                    }\n                  </div>\n                  <p className=\"font-small dark-grey-text text-right d-flex justify-content-center mb-3 pt-2\" />\n                </form>\n              </MDBCardBody>\n              <MDBModalFooter className=\"mx-5 pt-3 mb-1\">\n                <p className=\"font-small grey-text d-flex justify-content-end\">\n                    \n                  <Link to=\"/inscription\" className=\"blue-text ml-1\">\n                    S&apos;inscrire\n                  </Link>\n                </p>\n\n\n              </MDBModalFooter>\n            </MDBCard>\n          </MDBRow>\n        </MDBContainer>\n      </div>\n    );\n  }\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}