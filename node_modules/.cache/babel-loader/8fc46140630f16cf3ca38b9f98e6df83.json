{"ast":null,"code":"import _defineProperty from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{MDBContainer,MDBCol,MDBBtn}from'mdbreact';import\"./accueil.css\";import axios from'axios';import{MDBDropdown,MDBDropdownToggle,MDBDropdownMenu,MDBDropdownItem}from\"mdbreact\";import{Redirect}from'react-router';import{Link}from'react-router-dom';var HomePage=/*#__PURE__*/function(_Component){_inherits(HomePage,_Component);function HomePage(props){var _this;_classCallCheck(this,HomePage);_this=_possibleConstructorReturn(this,_getPrototypeOf(HomePage).call(this,props));_this.change=function(e){_this.setState(_defineProperty({},e.target.id,e.target.value));};_this.searchTitle=function(search){return function(e){console.log(search);var formData=new FormData();formData.append(\"title\",search);var url=\"http://localhost:8888/API/Accueil/recherche_titre.php\";axios.post(url,formData,{withCredentials:true}).then(function(response){return response.data;}).then(function(data){_this.setState({filter:data.results.livres});//\"filter\" contient les données reçues par le back-end \nconsole.log(_this.state.filter);});setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};};_this.searchAuthor=function(search){return function(e){console.log(search);var formData=new FormData();formData.append(\"author\",search);var url=\"http://localhost:8888/API/Accueil/recherche_author.php\";axios.post(url,formData,{withCredentials:true}).then(function(response){return response.data;}).then(function(data){_this.setState({filter:data.results.livres});//\"filter\" contient les données reçues par le back-end \nconsole.log(_this.state.filter);});setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};};_this.searchYear=function(search){return function(e){console.log(search);var formData=new FormData();formData.append(\"year\",search);var url=\"http://localhost:8888/API/Accueil/recherche_year.php\";axios.post(url,formData,{withCredentials:true}).then(function(response){return response.data;}).then(function(data){_this.setState({filter:data.results.livres});//\"filter\" contient les données reçues par le back-end \nconsole.log(_this.state.filter);});setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};};_this.searchEdition=function(search){return function(e){console.log(search);var formData=new FormData();formData.append(\"edition\",search);var url=\"http://localhost:8888/API/Accueil/recherche_edition.php\";axios.post(url,formData,{withCredentials:true}).then(function(response){return response.data;}).then(function(data){_this.setState({filter:data.results.livres});//\"filter\" contient les données reçues par le back-end \nconsole.log(_this.state.filter);});setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};};_this.searchTypeBook=function(search){return function(e){console.log(search);var formData=new FormData();formData.append(\"typeBook\",search);var url=\"http://localhost:8888/API/Accueil/recherche_typeBook.php\";axios.post(url,formData,{withCredentials:true}).then(function(response){return response.data;}).then(function(data){_this.setState({filter:data.results.livres});//\"filter\" contient les données reçues par le back-end \nconsole.log(_this.state.filter);});setTimeout(function(){_this.setState({error:''});},2000);e.preventDefault();};};_this.state={noSession:false,//booleen qui permet de verifier si la session de l'utilisateur est active, initialisé a \"faux\"\nsearch:'',//va contenir la valeur entrée dans la barre de recherche\nfilter:[],//va contenir les resultats de la recherche\nerror:''//va contenir l'erreur en cas d'erreur\n};_this.checkSession=_this.checkSession.bind(_assertThisInitialized(_this));_this.searchTitle=_this.searchTitle.bind(_assertThisInitialized(_this));_this.searchAuthor=_this.searchAuthor.bind(_assertThisInitialized(_this));_this.searchYear=_this.searchYear.bind(_assertThisInitialized(_this));_this.searchEdition=_this.searchEdition.bind(_assertThisInitialized(_this));_this.searchTypeBook=_this.searchTypeBook.bind(_assertThisInitialized(_this));return _this;}//fonction qui permet de fermer la session via le ficher PHP \"logout.php\" lorsque l'utilisateur appuie sur \"se deconnecter\"\n_createClass(HomePage,[{key:\"handleLogOut\",value:function handleLogOut(){axios.get(\"http://localhost:8888/API/MonCompte/logout.php\",{withCredentials:true})//succes deconnexion\n.then(function(response){console.log(\"successful logout\",response);this.setState({logOut:true});//booleen de connexion changé comme \"vrai\"\n}.bind(this))//echec deconnexion\n.catch(function(error){if(error.response&&error.response.status===403){console.log(error);}});}//Vérifie que la session est active\n},{key:\"checkSession\",value:function checkSession(){var _this2=this;axios.get(\"http://localhost:8888/API/Session/session.php\",{withCredentials:true}).then(function(response){console.log(response);}).catch(function(error){if(error.response&&error.response.status===404){_this2.setState({noSession:true});//s'il n'y a pas de session active, change la valeur du booleen comme \"vrai\"\nconsole.log(error);}});}//methode qui permet d'attribuer à \"search\" la valeur entrée au clavier par l'utilisateur\n},{key:\"render\",value:function render(){var container={height:270};var noSession=this.state.noSession;var bgRed={backgroundColor:'rgb(83, 4, 4)'};var logOut=this.state.logOut;//appel à la methode qui verifie la session\nthis.checkSession();//s'il n'y a pas de session active, redirection vers la page de connexion\nif(noSession){return React.createElement(Redirect,{to:\"/\"});}//Redirection vers page de connexion quand l'utilisateur se deconnecte\nif(logOut){return React.createElement(Redirect,{to:\"/\"});};//affichage du menu vertical qui redirige vers les differentes pages\n//affichage de la barre de recherche\n//affichage des filtres qui font appel aux differentes fonctions\nreturn React.createElement(\"div\",null,React.createElement(\"h1\",{className:\"myBibliBis\"},\"MyBibli\"),React.createElement(\"div\",{className:\"searchPosition\"},React.createElement(MDBCol,null,React.createElement(\"div\",{className:\"active-pink-3 active-pink-4 mb-4\"},React.createElement(\"input\",{className:\"form-control\",id:\"search\",type:\"text\",placeholder:\"Indiquez votre recherche...\",onChange:this.change})))),React.createElement(\"br\",null),React.createElement(\"div\",null,React.createElement(\"ul\",{className:\"ulFilter\"},React.createElement(\"li\",{className:\"liFilter\"},\"Puis s\\xE9lectionnez un filtre :  \"),React.createElement(\"li\",{className:\"liFilter\"},React.createElement(MDBBtn,{onClick:this.searchTitle(this.state.search),color:\"dark\",size:\"lg\"},\"Titre\")),React.createElement(\"li\",{className:\"liFilter\"},React.createElement(MDBBtn,{onClick:this.searchAuthor(this.state.search),color:\"dark\",size:\"lg\"},\"Auteur\")),React.createElement(\"li\",{className:\"liFilter\"},React.createElement(MDBBtn,{onClick:this.searchYear(this.state.search),color:\"dark\",size:\"lg\"},\"Ann\\xE9e de sortie\")),React.createElement(\"li\",{className:\"liFilter\"},React.createElement(MDBBtn,{onClick:this.searchEdition(this.state.search),color:\"dark\",size:\"lg\"},\"Edition\")),React.createElement(\"li\",{className:\"liFilter\"},React.createElement(MDBBtn,{onClick:this.searchTypeBook(this.state.search),color:\"dark\",size:\"lg\"},\"Type de livre\"))),React.createElement(\"ul\",{className:\"resultsSearch\"},this.state.filter?this.state.filter.map(function(livre){return React.createElement(\"li\",{className:\".liResults\",key:livre.id},livre.title,\", \",livre.author,\", \",livre.typeBook,\", sorti en \",livre.year,\", \\xE9dition \",livre.edition,\", achet\\xE9 le: \",livre.date,\", statut: \",livre.status);}):React.createElement(\"em\",null,\"Chargement...\"))),React.createElement(MDBDropdown,{className:\"drop\"},React.createElement(MDBDropdownToggle,{style:bgRed},React.createElement(\"div\",null,\"Contact\")),React.createElement(MDBDropdownMenu,{basic:true},React.createElement(MDBDropdownItem,{href:\"mailto:mybibli.sup@gmail.com\"},\"mybibli.sup@gmail.com\"))),React.createElement(MDBDropdown,{className:\"dropdownn\"},React.createElement(MDBDropdownToggle,{style:bgRed},\"Mon Compte\"),React.createElement(MDBDropdownMenu,{basic:true},React.createElement(MDBDropdownItem,null,React.createElement(Link,{to:\"/gererMonCompte\"},\"G\\xE9rer mon compte\")),React.createElement(MDBDropdownItem,{onClick:this.handleLogOut},React.createElement(Link,{to:\"/\"},\"Se d\\xE9connecter\")))),React.createElement(MDBContainer,{style:container,className:\"containerAcceuil\"},React.createElement(\"div\",{className:\"sidenav\"},React.createElement(\"br\",null),React.createElement(\"a\",{href:\"/mesLivres\"},\"Mes livres\"),React.createElement(\"br\",null),React.createElement(\"a\",{href:\"/ajoutlivre\"},\"Ajouter un livre\"),React.createElement(\"br\",null),React.createElement(\"a\",{href:\"/mesPrets\"},\"G\\xE9rer mes pr\\xEAts\"),React.createElement(\"br\",null),React.createElement(\"a\",{href:\"/prochainAchat\"},\"Mes prochains achats\"))));}}]);return HomePage;}(Component);export default HomePage;","map":{"version":3,"sources":["/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/src/components/Accueil/accueil.js"],"names":["React","Component","MDBContainer","MDBCol","MDBBtn","axios","MDBDropdown","MDBDropdownToggle","MDBDropdownMenu","MDBDropdownItem","Redirect","Link","HomePage","props","change","e","setState","target","id","value","searchTitle","search","console","log","formData","FormData","append","url","post","withCredentials","then","response","data","filter","results","livres","state","setTimeout","error","preventDefault","searchAuthor","searchYear","searchEdition","searchTypeBook","noSession","checkSession","bind","get","logOut","catch","status","container","height","bgRed","backgroundColor","map","livre","title","author","typeBook","year","edition","date","handleLogOut"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport {\n    MDBContainer,MDBCol, MDBBtn, \n  } from 'mdbreact';\nimport \"./accueil.css\";\nimport axios from 'axios';\nimport {  MDBDropdown,\n  MDBDropdownToggle, MDBDropdownMenu, MDBDropdownItem,  } from \"mdbreact\";\nimport { Redirect} from 'react-router';\nimport { Link } from 'react-router-dom';\n\n\n\nclass HomePage extends Component{\n    constructor(props){\n        super(props);\n        this.state = {\n          noSession: false,//booleen qui permet de verifier si la session de l'utilisateur est active, initialisé a \"faux\"\n      search:'',//va contenir la valeur entrée dans la barre de recherche\n      filter: [],//va contenir les resultats de la recherche\n      error:'',//va contenir l'erreur en cas d'erreur\n        }\n        this.checkSession = this.checkSession.bind(this);\n        this.searchTitle = this.searchTitle.bind(this);\n        this.searchAuthor = this.searchAuthor.bind(this);\n        this.searchYear= this.searchYear.bind(this);\n        this.searchEdition = this.searchEdition.bind(this);\n        this.searchTypeBook = this.searchTypeBook.bind(this);\n    }\n\n    //fonction qui permet de fermer la session via le ficher PHP \"logout.php\" lorsque l'utilisateur appuie sur \"se deconnecter\"\n    handleLogOut () {\n      axios.get(\"http://localhost:8888/API/MonCompte/logout.php\", {withCredentials: true})\n    \n      //succes deconnexion\n      .then(function(response){\n        console.log(\"successful logout\", response);\n        this.setState({logOut: true});//booleen de connexion changé comme \"vrai\"\n      }.bind(this))\n    \n      //echec deconnexion\n      .catch((error) => {\n        if(error.response && error.response.status=== 403){\n          console.log(error);\n        }\n      });\n    }\n    \n\n  //Vérifie que la session est active\n    checkSession () {\n        axios.get(\"http://localhost:8888/API/Session/session.php\", {withCredentials: true})\n    \n        .then(function(response){\n          console.log(response);\n        })\n    \n        .catch((error) => {\n          if(error.response && error.response.status=== 404){\n            this.setState({noSession: true});//s'il n'y a pas de session active, change la valeur du booleen comme \"vrai\"\n            console.log(error);\n          }\n        });\n      }\n   \n      //methode qui permet d'attribuer à \"search\" la valeur entrée au clavier par l'utilisateur\n  change = e => {\n    this.setState({\n      [e.target.id]: e.target.value,\n      });\n  }  \n\n  //Recherche avec le filtre par titre\n  searchTitle = (search) => e => {\n    console.log(search);\n    let formData = new FormData();\n    formData.append(\"title\",search);\n    const url = \"http://localhost:8888/API/Accueil/recherche_titre.php\"\n    axios.post(url, formData, {withCredentials: true})\n\n    .then(response => response.data)\n    \n    .then((data) => {\n      this.setState({filter: data.results.livres});//\"filter\" contient les données reçues par le back-end \n      console.log(this.state.filter)\n    })\n      \n    \n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n  \n  //Recherche avec le filtre par auteur\n  searchAuthor = (search) => e => {\n    console.log(search);\n    let formData = new FormData();\n    formData.append(\"author\",search);\n    const url = \"http://localhost:8888/API/Accueil/recherche_author.php\"\n    axios.post(url, formData, {withCredentials: true})\n\n\n    .then(response => response.data)\n    \n    .then((data) => {\n      this.setState({filter: data.results.livres});//\"filter\" contient les données reçues par le back-end \n      console.log(this.state.filter)\n    })\n      \n    \n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n\n  //Recherche avec le filtre par année de sortie\n  searchYear = (search) => e => {\n    console.log(search);\n    let formData = new FormData();\n    formData.append(\"year\",search);\n    const url = \"http://localhost:8888/API/Accueil/recherche_year.php\"\n    axios.post(url, formData, {withCredentials: true})\n\n    .then(response => response.data)\n    \n    .then((data) => {\n      this.setState({filter: data.results.livres});//\"filter\" contient les données reçues par le back-end \n      console.log(this.state.filter)\n    })\n      \n    \n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n\n  //Recherche avec le filtre par edition\n  searchEdition = (search) => e => {\n    console.log(search);\n    let formData = new FormData();\n    formData.append(\"edition\",search);\n    const url = \"http://localhost:8888/API/Accueil/recherche_edition.php\"\n    axios.post(url, formData, {withCredentials: true})\n\n    .then(response => response.data)\n    \n    .then((data) => {\n      this.setState({filter: data.results.livres});//\"filter\" contient les données reçues par le back-end \n      console.log(this.state.filter)\n    })\n      \n    \n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n\n  //Recherche avec le filtre par type de livre\n  searchTypeBook = (search) => e => {\n    console.log(search);\n    let formData = new FormData();\n    formData.append(\"typeBook\",search);\n    const url = \"http://localhost:8888/API/Accueil/recherche_typeBook.php\"\n    axios.post(url, formData, {withCredentials: true})\n\n    .then(response => response.data)\n    \n    .then((data) => {\n      this.setState({filter: data.results.livres});//\"filter\" contient les données reçues par le back-end \n      console.log(this.state.filter)\n    })\n      \n    \n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n\n\n    render() {\n        const container = {height:270};\n        const {noSession} = this.state;\n        const bgRed = {backgroundColor: 'rgb(83, 4, 4)'}\n        const{logOut} = this.state;\n\n        //appel à la methode qui verifie la session\n        this.checkSession ();\n\n        //s'il n'y a pas de session active, redirection vers la page de connexion\n        if(noSession){\n            return <Redirect to=\"/\"/>;\n          }\n          //Redirection vers page de connexion quand l'utilisateur se deconnecte\n  if(logOut){\n    return <Redirect to=\"/\"/>;\n  };\n  \n\n\n //affichage du menu vertical qui redirige vers les differentes pages\n        //affichage de la barre de recherche\n        //affichage des filtres qui font appel aux differentes fonctions\n        return(\n            <div>\n            <h1 className=\"myBibliBis\">MyBibli</h1>\n            <div className=\"searchPosition\">\n              <MDBCol>\n                <div className=\"active-pink-3 active-pink-4 mb-4\">\n                  <input className=\"form-control\" id=\"search\" type=\"text\" placeholder=\"Indiquez votre recherche...\"  onChange={this.change}/>\n                </div>\n              </MDBCol>\n            </div>\n            <br></br>\n            <div >\n            <ul className=\"ulFilter\">\n            <li className=\"liFilter\">Puis sélectionnez un filtre :  </li>\n            <li className=\"liFilter\">\n              <MDBBtn  onClick={this.searchTitle(this.state.search)} color=\"dark\" size=\"lg\">Titre</MDBBtn>\n            </li>\n            <li className=\"liFilter\">\n              <MDBBtn  onClick={this.searchAuthor(this.state.search)} color=\"dark\" size=\"lg\">Auteur</MDBBtn>\n              </li>\n            <li className=\"liFilter\">\n              <MDBBtn  onClick={this.searchYear(this.state.search)} color=\"dark\" size=\"lg\">Année de sortie</MDBBtn>\n            </li>\n            <li className=\"liFilter\">\n              <MDBBtn  onClick={this.searchEdition(this.state.search)} color=\"dark\" size=\"lg\">Edition</MDBBtn>\n            </li>\n            <li className=\"liFilter\">\n              <MDBBtn  onClick={this.searchTypeBook(this.state.search)} color=\"dark\" size=\"lg\">Type de livre</MDBBtn>\n            </li>\n\n            </ul>\n            <ul className=\"resultsSearch\"> \n                  { this.state.filter ? this.state.filter.map(livre => (\n                      <li className=\".liResults\" key={livre.id}>{livre.title}, {livre.author}, {livre.typeBook}, sorti en {livre.year}, édition {livre.edition}, acheté le: {livre.date}, statut: {livre.status}</li>\n                  )) : <em>Chargement...</em>}\n                </ul>\n\n        </div>\n        \n        <MDBDropdown className=\"drop\">\n                <MDBDropdownToggle  style={bgRed}>\n                  <div >Contact</div>\n                </MDBDropdownToggle>\n                <MDBDropdownMenu basic>\n                  <MDBDropdownItem href=\"mailto:mybibli.sup@gmail.com\">mybibli.sup@gmail.com</MDBDropdownItem>  \n                </MDBDropdownMenu>\n              </MDBDropdown>\n\n        <MDBDropdown  className=\"dropdownn\">\n      <MDBDropdownToggle style={bgRed}>\n       Mon Compte\n      </MDBDropdownToggle>\n      <MDBDropdownMenu basic>\n        <MDBDropdownItem>\n        <Link to=\"/gererMonCompte\">\n                    Gérer mon compte\n                    </Link>\n                    </MDBDropdownItem>\n        <MDBDropdownItem onClick = {this.handleLogOut}><Link to=\"/\">\n                    Se déconnecter\n                    </Link>\n                    </MDBDropdownItem>\n      </MDBDropdownMenu>\n    </MDBDropdown>\n            \n        <MDBContainer style={container} className=\"containerAcceuil\">\n        \n          <div className=\"sidenav\">\n          <br></br>\n            <a href=\"/mesLivres\">Mes livres</a>\n            <br></br>\n            <a href=\"/ajoutlivre\">Ajouter un livre</a>\n            <br></br>\n            <a href=\"/mesPrets\">Gérer mes prêts</a>\n            <br></br>\n            <a href=\"/prochainAchat\">Mes prochains achats</a>\n          </div>      \n        </MDBContainer>\n      </div>\n      \n        );\n    }\n}\n\nexport default HomePage;"]},"metadata":{},"sourceType":"module"}