{"ast":null,"code":"var _jsxFileName = \"/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/src/components/AjoutLivre/ajoutLivre.js\";\n\n/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React from 'react';\nimport './ajoutLivre.css';\nimport axios from 'axios';\nimport { Redirect } from 'react-router';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { MDBContainer, MDBRow, MDBCard, MDBCardBody } from 'mdbreact';\n\nclass AddBook extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.change = async e => {\n      await this.setState({\n        [e.target.id]: e.target.value\n      });\n    };\n\n    this.handleSubmitBook = e => {\n      const {\n        title,\n        author,\n        year,\n        date,\n        edition,\n        typeBook\n      } = this.state;\n\n      if (title && author && year && date && edition && typeBook) {\n        console.log(this.state);\n        let formData = new FormData();\n        formData.append(\"title\", this.state.title);\n        formData.append(\"author\", this.state.author);\n        formData.append(\"year\", this.state.year);\n        formData.append(\"date\", this.state.date);\n        formData.append(\"edition\", this.state.edition);\n        formData.append(\"typeBook\", this.state.typeBook);\n        const url = \"http://localhost:8888/API/AjouterLivre/ajout_livre_back.php\";\n        axios.post(url, formData, {\n          withCredentials: true\n        }) //succès ajout livre\n        .then(function (response) {\n          console.log(response);\n          toast.success(' Livre ajouté à votre bibliothèque', {\n            position: \"top-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined\n          });\n        }) //echec ajout livre\n        .catch(error => {\n          if (error.response && error.response.status === 403) {\n            console.log(error);\n            toast.warn('Attention : ce livre existe déjà dans votre bibliothèque', {\n              position: \"top-center\",\n              autoClose: 5000,\n              hideProgressBar: false,\n              closeOnClick: true,\n              pauseOnHover: true,\n              draggable: true,\n              progress: undefined\n            });\n          }\n        });\n      } else {\n        //cas ou les champs ne sont pas correctement remplis\n        this.setState({\n          error: 'Veuillez saisir tous les champs !'\n        });\n      }\n\n      setTimeout(() => {\n        this.setState({\n          error: ''\n        });\n      }, 2000);\n      e.preventDefault();\n    };\n\n    this.state = {\n      noSession: false,\n      //booleen qui permet de verifier si la session de l'utilisateur est active, initialisé a \"faux\"\n      title: null,\n      //va contenir la valeur entrée pour le champs \"titre\" du formulaire\n      author: null,\n      //va contenir la valeur entrée pour le champs \"auteur\" du formulaire\n      year: null,\n      //va contenir la valeur entrée pour le champs \"année de sortie\" du formulaire\n      date: null,\n      //va contenir la valeur entrée pour le champs \"date d'achat\" du formulaire\n      edition: null,\n      //va contenir la valeur entrée pour le champs \"edition\" du formulaire\n      typeBook: null,\n      //va contenir la valeur entrée pour le champs \"type\" du formulaire\n      error: '' //va contenir l'erreur en cas d'erreur\n\n    };\n    this.checkSession = this.checkSession.bind(this);\n  } //Vérifie que la session est active\n\n\n  checkSession() {\n    axios.get(\"http://localhost:8888/API/Session/session.php\", {\n      withCredentials: true\n    }).then(function (response) {\n      console.log(response);\n    }).catch(error => {\n      if (error.response && error.response.status === 404) {\n        this.setState({\n          noSession: true\n        }); //s'il n'y a pas de session active, change la valeur du booleen comme \"vrai\"\n\n        console.log(error);\n      }\n    });\n  } //methode qui permet d'attribuer à \"title\", \"author\", \"year\", \"date\", \"edition\" et \"typeBook\" les valeurs entrées au clavier par l'utilisateur\n\n\n  render() {\n    const {\n      error\n    } = this.state;\n    const container = {\n      height: 1000\n    };\n    const {\n      noSession\n    } = this.state; //appel à la methode qui verifie la session\n\n    this.checkSession(); //s'il n'y a pas de session active, redirection vers la page de connexion\n\n    if (noSession) {\n      return React.createElement(Redirect, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      });\n    }\n\n    return React.createElement(MDBContainer, {\n      style: container,\n      className: \"containerInscription\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140\n      },\n      __self: this\n    }, React.createElement(MDBRow, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"colInscription\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    }, React.createElement(MDBCard, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }, React.createElement(MDBCardBody, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, React.createElement(\"form\", {\n      onSubmit: this.handleSubmitBook,\n      className: \"form\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"text-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      className: \"dark-grey-text mb-5\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, \"Ajouter un livre\")), React.createElement(\"div\", {\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      htmlFor: \"title\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }, \"Titre\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"title\",\n      placeholder: \"Titre\",\n      className: \"form-control\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"author\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    }, \"Auteur\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"author\",\n      placeholder: \"Auteur\",\n      className: \"form-control\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"year\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, \"Ann\\xE9e de sortie\"), React.createElement(\"input\", {\n      type: \"number\",\n      id: \"year\",\n      className: \"form-control\",\n      placeholder: \"Ann\\xE9e\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"date\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, \"Date d'achat\"), React.createElement(\"input\", {\n      type: \"date\",\n      id: \"date\",\n      placeholder: \"jj/mm/aa\",\n      className: \"form-control\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"edition\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"Edition\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"edition\",\n      placeholder: \"Edition\",\n      className: \"form-control\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211\n      },\n      __self: this\n    }), React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }), React.createElement(\"label\", {\n      htmlFor: \"typeBook\",\n      className: \"grey-text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222\n      },\n      __self: this\n    }, \"Type\"), React.createElement(\"input\", {\n      type: \"text\",\n      id: \"typeBook\",\n      placeholder: \"Type\",\n      className: \"form-control\",\n      onChange: this.change,\n      required: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"text-center py-4 mt-3\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-primary\",\n      onClick: this.handleSubmitBook,\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237\n      },\n      __self: this\n    }, \"Valider\"), React.createElement(ToastContainer, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238\n      },\n      __self: this\n    }), error && React.createElement(\"p\", {\n      className: \"error\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241\n      },\n      __self: this\n    }, error))))))));\n  }\n\n}\n\nexport default AddBook;","map":{"version":3,"sources":["/Users/Megane/MonProjet/2019-l2aj2/trunk/2019-l2aj2/APP_Mac/src/components/AjoutLivre/ajoutLivre.js"],"names":["React","axios","Redirect","ToastContainer","toast","MDBContainer","MDBRow","MDBCard","MDBCardBody","AddBook","Component","constructor","props","change","e","setState","target","id","value","handleSubmitBook","title","author","year","date","edition","typeBook","state","console","log","formData","FormData","append","url","post","withCredentials","then","response","success","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","catch","error","status","warn","setTimeout","preventDefault","noSession","checkSession","bind","get","render","container","height"],"mappings":"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","sourcesContent":["/* eslint-disable jsx-a11y/label-has-associated-control */\nimport React from 'react';\nimport './ajoutLivre.css';\nimport axios from 'axios';\nimport { Redirect} from 'react-router';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\n  \n\n\n\nimport {\n  MDBContainer, MDBRow, MDBCard, MDBCardBody,\n} from 'mdbreact';\n\nclass AddBook extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      noSession: false,//booleen qui permet de verifier si la session de l'utilisateur est active, initialisé a \"faux\"\n      title: null,//va contenir la valeur entrée pour le champs \"titre\" du formulaire\n      author: null,//va contenir la valeur entrée pour le champs \"auteur\" du formulaire\n      year: null,//va contenir la valeur entrée pour le champs \"année de sortie\" du formulaire\n      date: null,//va contenir la valeur entrée pour le champs \"date d'achat\" du formulaire\n      edition: null,//va contenir la valeur entrée pour le champs \"edition\" du formulaire\n      typeBook: null,//va contenir la valeur entrée pour le champs \"type\" du formulaire\n      error: '',//va contenir l'erreur en cas d'erreur\n\n    }\n    this.checkSession = this.checkSession.bind(this);\n  }\n\n  //Vérifie que la session est active\n  checkSession () {\n    axios.get(\"http://localhost:8888/API/Session/session.php\", {withCredentials: true})\n\n    .then(function(response){\n      console.log(response);\n    })\n\n    .catch((error) => {\n      if(error.response && error.response.status=== 404){\n        this.setState({noSession: true});//s'il n'y a pas de session active, change la valeur du booleen comme \"vrai\"\n        console.log(error);\n      }\n    });\n  }\n\n  //methode qui permet d'attribuer à \"title\", \"author\", \"year\", \"date\", \"edition\" et \"typeBook\" les valeurs entrées au clavier par l'utilisateur\n  change = async e => {\n    await this.setState({\n      [e.target.id]: e.target.value,\n    });\n  }\n\n//methode qui permet d'envoyer les données au fichier PHP \"ajout_livre_back.php\" afin d'enregistrer le livre, lorque l'utilisateur appuie sur le bouton \"valider\"\n  handleSubmitBook = e => {\n\n    const {\n      title, author, year, date, edition, typeBook,\n    } = this.state;\n\n    if (title && author && year && date && edition && typeBook ) {\n\n        \n        console.log(this.state);\n        let formData = new FormData();\n        formData.append(\"title\",this.state.title);\n        formData.append(\"author\",this.state.author);\n        formData.append(\"year\",this.state.year);\n        formData.append(\"date\",this.state.date);\n        formData.append(\"edition\",this.state.edition);\n        formData.append(\"typeBook\",this.state.typeBook);\n        const url = \"http://localhost:8888/API/AjouterLivre/ajout_livre_back.php\";\n        axios.post(url,formData, {withCredentials: true})\n\n        //succès ajout livre\n        .then(function(response){\n          console.log(response);\n          toast.success(' Livre ajouté à votre bibliothèque', {\n            position: \"top-center\",\n            autoClose: 5000,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n            });\n          \n          })\n        \n        //echec ajout livre\n        .catch((error) => {\n          if (error.response && error.response.status === 403){\n            console.log(error);\n            toast.warn('Attention : ce livre existe déjà dans votre bibliothèque', {\n              position: \"top-center\",\n              autoClose: 5000,\n              hideProgressBar: false,\n              closeOnClick: true,\n              pauseOnHover: true,\n              draggable: true,\n              progress: undefined,\n              });\n            \n          }\n        }); \n\n        \n    } else {\n      //cas ou les champs ne sont pas correctement remplis\n      this.setState({\n        error: 'Veuillez saisir tous les champs !',\n      });\n    }\n    setTimeout(() => {\n      this.setState({\n        error: '',\n      });\n    }, 2000);\n          \n    e.preventDefault();\n  }\n\n  render() {\n    const { error } = this.state;\n    const container = {height: 1000};\n    const {noSession} = this.state;\n    \n\n    //appel à la methode qui verifie la session\n    this.checkSession ();\n\n     //s'il n'y a pas de session active, redirection vers la page de connexion\n     if(noSession){\n      return <Redirect to=\"/\"/>;\n    }\n\n    return (\n      <MDBContainer style={container} className=\"containerInscription\">\n        <MDBRow>\n          <div className=\"colInscription\">\n            <MDBCard>\n              <MDBCardBody>\n                <form onSubmit={this.handleSubmitBook} className=\"form\">\n                  <div className=\"text-center\">\n                    <h2 className=\"dark-grey-text mb-5\">\n                      Ajouter un livre\n                    </h2>\n                  </div>\n                  <div className=\"grey-text\">\n                    <label htmlFor=\"title\" className=\"grey-text\">\n                      Titre\n                    </label>\n                    <input\n                      type=\"text\"\n                      id=\"title\"\n                      placeholder=\"Titre\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                      required\n                    />\n\n                    <br />\n\n                    <label htmlFor=\"author\" className=\"grey-text\">\n                      Auteur\n                    </label>\n                    <input\n                      type=\"text\"\n                      id=\"author\"\n                      placeholder=\"Auteur\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                      required\n                    />\n\n                    <br />\n\n                    <label htmlFor=\"year\" className=\"grey-text\">\n                      Année de sortie\n                    </label>\n                    <input\n                      type=\"number\"\n                      id=\"year\"\n                      className=\"form-control\"\n                      placeholder=\"Année\"\n                      onChange={this.change}\n                      required\n                    />\n\n                    <br />\n\n                    <label htmlFor=\"date\" className=\"grey-text\">\n                      Date d&apos;achat\n                    </label>\n                    <input\n                      type=\"date\"\n                      id=\"date\"\n                      placeholder=\"jj/mm/aa\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                      required\n                    />\n\n                    <br />\n\n                    <label htmlFor=\"edition\" className=\"grey-text\">\n                      Edition\n                    </label>\n                    <input\n                      type=\"text\"\n                      id=\"edition\"\n                      placeholder=\"Edition\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                      required\n                    />\n\n                    <br />\n\n                    <label htmlFor=\"typeBook\" className=\"grey-text\">\n                      Type\n                    </label>\n                    <input\n                      type=\"text\"\n                      id=\"typeBook\"\n                      placeholder=\"Type\"\n                      className=\"form-control\"\n                      onChange={this.change}\n                      required\n                    />\n\n\n                  </div>\n                  <div className=\"text-center py-4 mt-3\">\n                    <button className=\"btn btn-primary\" onClick={this.handleSubmitBook} type=\"submit\">Valider</button>\n                    <ToastContainer />\n                    {\n                     error && (\n                     <p className=\"error\">{error}</p>\n                     )\n                    }\n                  </div>\n\n                </form>\n\n              </MDBCardBody>\n            </MDBCard>\n          </div>\n        </MDBRow>\n      </MDBContainer>\n\n    );\n  }\n}\n\nexport default AddBook;"]},"metadata":{},"sourceType":"module"}